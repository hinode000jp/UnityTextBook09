# Gitの基本的な使い方１

## Gitとは

<br>

### Gitの概要

![](img/Git-Logo-2Color.png)

Gitを簡単に説明すると、バージョン管理システム、つまり変更履歴を管理するシステムの一つです。

例えば、自身で新しいWebサイトを作成しているとします。  
そこで新しい追加機能、例えばGoogleフォームを埋め込んでみたり、地図を表示するようにしたいとします。

ところが実際に実装してみたところ、うまく動かないばかりか、新機能実装前までは正常に動いていた部分までもおかしくなってしまいました。  
とりあえず元の状態に戻そうと考えますが、だいぶコードを追加してしまったため、どこを追加したのかわからなくなってしまったとします。

エディタの「戻る」ボタンでもある程度は戻れますが、一度エディタを閉じてしまうと戻れなくなってしまいます。  
一番身近な方法としては、新機能追加前のファイルをコピーしておいて、別のフォルダなどにバックアップとして保存しておくことです。ですが、この方法だと新機能の追加やバグ修正作業のたびに新しくバックアップを作成し保存しなければなりません。また、バックアップが増えてくるとどのファイルがどの機能追加前のバックアップなのか、最新の状態はどのファイルなのかがわからなくなる可能性があります。

![](img/backup.png)

さらに、複数人で同じプロジェクトを編集する場合、誰が最後に書き換えたのか、どこをどのように変更したのかを共有するのが大変だったり、同時に同じファイルを変更して先に編集した人のデータを消してしまうといった問題が発生するかと思います。このような問題を解決するためにGitというシステムが開発されました。

---

### 分散型バージョン管理システム

現在のバージョン管理システムは集中型バージョン管理システムと分散型バージョン管理システムがあり、Gitは分散型のバージョン管理システムの１つです。

分散型と集中型の詳細の説明は省きますが、詳しく知りたい方は[こちら](https://www.atmarkit.co.jp/ait/articles/1307/05/news028_3.html)をご確認ください。

分散型バージョン管理システムを簡単に説明すると、ローカル環境（自分のPCなど）にも変更履歴を含む完全なリポジトリの複製を作成する仕組みのことです。

ローカル環境なので、インターネットに繋がっていなくてもバージョン管理を行うことができます。

---

### ローカルリポジトリとリモートリポジトリ

リポジトリとは直訳すると「貯蔵庫」という意味になります。

バージョン管理システムで使用するリポジトリとは、そのファイルの変更履歴やファイル自体を記録しておく場所のことです。

そしてこのリポジトリにはローカルリポジトリとリモートリポジトリの２つがあります。

- ローカルリポジトリ
  - 自身のパソコンなどで使用するリポジトリ
- リモートリポジトリ
  - サーバーに配置して別のパソコンや複数人で共有するためのリポジトリ
  - 
ローカルリポジトリはリモートリポジトリにアップロードしなければ自分のパソコン上だけで変更履歴を管理できるので、複数人で別々の作業を効率よく行うことができます。

---

### Gitの用語

Gitを使う上で一番学習を難しくしているのが専門用語の多さです。

プログラミングを学ぶ上ではどうしても専門用語を多く覚える必要があるのですが、専門用語はどの分野でも必ず必要になる知識なので少しずつ覚えていきましょう。

今回はGitを使う上で必要になる基本的な用語をいくつか紹介します。

|  |  |

| 用語 | 意味 |
| :-- | :-- |
| リポジトリ | ファイルやディレクトリの状態を記録する場所。 |
| ディレクトリ | 基本的にはフォルダと同義。（厳密には違う） |
| コミット | ファイルやディレクトリの追加・変更をリポジトリに記録すること。コミットを行うことで変更履歴を記録できる。（１つ前の状態に戻す＝１つ前のコミットに戻す）|
| ワークツリー | Gitの管理下に置かれたディレクトリのこと。 |
| インデックス | リポジトリにコミットする準備をする場所。リポジトリとワークツリーの間にある。（ステージング・エリアとも呼ばれている） |
| ブランチ | コミットの履歴を分岐すること。バリエーション違いを作れる。リポジトリを作った時に自動で作られる（デフォルトの）ブランチが「master」ブランチ。ちなみにブランチを作ることをGitでは「ブランチを切る」と言う。 |
| マージ | ブランチとブランチを合体させること。 |

<p class="point">
Gitでは、コミットを実行したときにワークツリーから直接リポジトリ内に状態を記録するのではなく、その間にあるインデックスの設定された状態を記録するようになっています。なぜそのようになっているのかというと、ワークツリー内にあるコミットする必要のないファイルを除外したり、ファイルの一部の変更だけをコミットできるようにするためです。そのためコミットしたいファイルだけをインデックスに登録して履歴を残すシステムになりました。
</p>

これ以外にもたくさん専門用語があるのですが、そちらはこの教材を通して学んでいきましょう。

---

<br>

## Gitの使用方法

Gitを使う方法は色々あるのですが、大きく分けて2つあります。

１つはターミナル・コマンドプロンプトからテキストで操作する方法（CUI）と、もう１つはマウスなどを使って直感的に操作する方法（GUI）です。

よくGitの初心者向けの情報サイトなどにはGUIツールを使った説明が紹介されています。

しかし、Gitの使い方がよくわからない状態でGUIツールをインストールして使ってみると、どのボタンがどのような意味なのかよくわからないまま手順通りマウスをクリックしていくだけになってしまって、予期せぬエラーの対処方法やGUIツールを変更したら操作方法が分からなくなってしまったなんてことが起きてしまいます。

もちろんGUIツールは非常に便利で、使い方と操作の意味さえ理解できればGit管理が非常に楽になります。

GitのGUIツールとしてとても有名なものに「Sourcetree」というものがあります。

![](img/image1-1.png)

Sourcetreeは多くの企業で使われているGit無料クライアントです。

Sourcetreeは、Atlassian社が提供しており、GitだけでなくMercurial（hg）にも対応しています。Gitのファサードとして働き、GUIでの操作により内部でGitコマンドを実行してくれる仕組みになっています。そのため、Gitコマンドを知っておくと、内部でどのようなコマンドが実行されているのか、よりイメージしやすいでしょう。

グラフィカルなインターフェイスを備えており、リポジトリの操作を視覚的に行うことができます。コマンドを打つ必要がないため、コマンドの打ち間違えが発生することもありません。また、Gitの代表的なブランチモデルのひとつである、「git-flow」に対応しています。ワンクリックでgit-flowの操作が行えるので、同ブランチモデルを採用しているプロジェクトでは非常に役立つことでしょう。

---

<br>

## ローカルリポジトリの作成

まずは新規でローカルリポジトリを作成しましょう。

![](img/image1-2.png)

SourceTreeから「新規 -> ローカルリポジトリを作成」を選択してください。

そして保存先を指定して作成を押してください。

![](img/image1-3.png)

そうすると、このように新規でリポジトリが作成されました。

<br>

## コミットしてみる

今回は初めてのGitなので、Unityではなく簡単なHTMLファイルを作成してそちらを利用したいと思います。

こちらのフォルダに新規で「index.html」ファイルを作成し、以下のコードを記述して保存してください。

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>Gitテスト</title>
</head>
<body>
    <h1>初めてのGit</h1>
</body>
</html>
```

書き終わりましたら保存してあることを確認し、Sourcetreeを開きましょう。


![](img/image1-4.png)

そうすると、このようにSourceTreeが変更されました。

![](img/image1-5.png)

次にGitにコミットしたいファイルにチェックをつけます。基本的に全ての変更ファイルをコミットするかと思いますので、「保存先のファイル、パス順」というところのチェックボックスにチェックをつけていただくと全てのファイルがチェック状態になります。

これがインデックスに登録状態です。

最後にコミットメッセージに「first commit」と入力し、右下のコミットをクリックすればコミットは完了です。

![](img/image1-6.png)

履歴を確認してもらうときちんと先ほどのindex.htmlファイルが登録されているのが確認できます。

少しindex.htmlファイルを変更してみましょう。

```html
<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <title>Gitテスト</title>
    </head>
    <body>
        <h1>初めてのGit</h1>
        <p>変更部分</p>
    </body>
</html>
```

![](img/image1-7.png)

そうすると、このようにまたSourcetreeに変更が反映されますので同じようにチェックをつけてコミットメッセージを入力し、コミットをしてください。

![](img/image1-8.png)

履歴を確認すると、このように変更内容が反映されています。


## ブランチを切ってみる

次にブランチを切ってみたいと思います。

ブランチを切るとは、「履歴を分岐」させるという意味です。

![](img/アートボード%201.png)

ブランチ（branch）とは、１つのプロジェクトから分岐させることにより、プロジェクト本体に影響を与えずに開発を行える機能のことを言います。

ブランチを直訳すると「木の枝、分岐」という意味になります。ブランチは現在リリースされているバージョン、もしくは正常に動いているバージョンのソフトウェアから枝分かれして他の作業を行うときに使われます。

ブランチは安定したバージョンをMasterブランチと呼び、プログラムの修正や機能の追加を行うときにブランチを追加（ブランチを切る）し、機能ごとなどのブランチで作業を行います。そのため、分岐したブランチの内容は他のブランチに影響を与えず、複数人が同時並行で作業を行うことができます。

また、分岐したブランチは他のブランチと合流することで、１つのブランチに統合し直すことができます。このような統合をマージと呼びます。  
リポジトリに最初のコミットを行うと、Gitはmasterという名前のブランチを作成します。そのため、それ以降のコミットはブランチを切らない限りmasterブランチに追加されていきます。しかし、先ほども言った通りmasterブランチは安定したバージョンやリリースされている状態を残しておくブランチですので、masterブランチで修正や機能の追加などをするのは好ましくありません。

そこで統合ブランチとトピックブランチと呼ばれる２種類のブランチを使った運用方法が使われてきました。  
統合ブランチにはmasterなどが含まれます。統合ブランチは常に安定したプロジェクトなどを置いておく場所です。  
トピックブランチは新機能の追加作業やバグの修正のたびに統合ブランチから分岐して作成されます。  
ちなみにGitの運用方法として一番有名なものに「[A successful Git branching model](https://nvie.com/posts/a-successful-git-branching-model/)」というものがあります。

![](img/Git-branching-model.png)

こちらの説明を入れると長くなるので詳細は省きますが、オランダのエンジニアの方が提唱したブランチの運用方法で現在では多くのエンジニアや企業で取り入れられている方法です。

今回の教材ではmasterブランチとトピックブランチの２つのブランチのみ使用しますが、ある程度運用に慣れてきたらこちらの運用方法も試してみるといいと思います。

早速やってみましょう。

![](img/image1-9.png)

まずは上のブランチという項目をクリックして、新規ブランチを作成します。名前は今回は「test」としました。


![](img/image1-10.png)

そうすると、こちらのブランチの部分に新しくtestという名前のブランチが作成され、そちらにマークがついているかと思います。

これは現在の作業ブランチがtestであるという意味になっています。

つまり、ここでいくら変更を加えてもmasterブランチの内容ば変化しないので、どんどん変更することができます。

このtestブランチで以下のように変更してコミットしてください。

```html
<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <title>Gitテスト</title>
    </head>
    <body>
        <h1>初めてのGit</h1>
        <p>変更部分</p>
        <p>testブランチで変更</p>
    </body>
</html>
```

そうすると、Sourcetreeでtestブランチの内容がMasterブランチよりも上に表示されました。

次に一度ブランチをMasterに戻しましょう。

そうすると、先ほど追加した`<p>`タグが消えているかと思います。これはtestブランチで編集したものなのでMasterブランチには影響していないためです。

Masterブランチに戻したら今度は`<h2>`を追加してください。

```html
<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <title>Gitテスト</title>
    </head>
    <body>
        <h1>初めてのGit</h1>
        <p>変更部分</p>
        <h2>Masterで追加</h2>
    </body>
</html>
```

![](img/image1-11.png)

そうすると、このようにMasterとtestブランチが枝分かれしたかと思います。

これでMasterブランチとtestブランチで内容が変わっているかと思います。

---

<br>

## マージしてみる

最後にマージ（ブランチ同士を合体させる）をテストしてみたいと思います。

今回はtestの内容をMasterにマージしてみましょう。

![](img/image1-12.png)

現在の作業ブランチがMasterであることを確認し、上のマージをクリックします。

そうすると、どのブランチをマージ（合体）させるかを選択できるのでtestブランチを選択し、OKボタンをクリックしてください。

![](img/image1-13.png)

そうすると、今度はこのような画面が表示されました。

これはMasterブランチとtestブランチが同じ箇所を変更しているのでコンフリクト（競合）が発生しましたよという意味です。

Gitで作業をしているとたまにこのようなコンフリクトが起こるので、その場合は慌てずに処理をしましょう。

まずはindex.htmlファイルを確認してください。

![](img/image1-14.png)

そうすると、このように表示されているかと思います。

testブランチで追加した`<p>`タグと、Masterブランチで追加した`<h2>`タグが競合しているようです。

今回はどちらも残しておきたいので以下のように修正してください。

```html
<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <title>Gitテスト</title>
    </head>
    <body>
        <h1>初めてのGit</h1>
        <p>変更部分</p>
        <h2>Masterで追加</h2>
        <p>testブランチで変更</p>
    </body>
</html>
```

![](img/image1-15.png)

そしてまたSourcetreeでコミットを行います。


![](img/image1-16.png)

そうすると、このように無事Masterブランチにtestブランチをマージすることができました。

---

なぜこのようにブランチを切るのかというと、基本的にMasterブランチは納品、または公開用のエラーのないファイルを管理するブランチとして残し、別のブランチで機能を追加したり、エラーを修正したりする作業用のブランチとして分けることにより、仮に作業していたブランチで修正できないような状態になってもMasterブランチには納品用、または公開用のデータがあるのでそこからやり直すことが可能になるからです。

<br>

この一連の流れがローカルでのGitの使い方です。

次はリモートリポジトリを作成し、プッシュ（アップロード）してみたいと思います。